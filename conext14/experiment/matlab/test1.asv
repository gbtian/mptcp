M=1000000;
K=1000;
x=1:2:1190;
wts = (repmat(1/5,5,1));



%no limit
data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\mpip.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\mptcp.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\together.csv');

mpip_no_limit = mean(data1(:,1))/M;
mptcp_no_limit = mean(data2(:,1))/M;
together_no_limit = mean(data3(:,1))/M;

error_mpip_no_limit = std(data1(:,1)/M);
error_mptcp_no_limit = std(data2(:,1)/M);
error_together_no_limit = std(data3(:,1)/M);


data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\1.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\2.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\3.csv');
data4 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\4\4.csv');

tp1_no_limit = mean(data1(:,8)*8000/M);
tp2_no_limit = mean(data2(:,8)*8000/M);
tp3_no_limit = mean(data3(:,8)*8000/M);
tp4_no_limit = mean(data4(:,8)*8000/M);

error_tp1_no_limit = std(data1(:,8)*8000/M);
error_tp2_no_limit = std(data2(:,8)*8000/M);
error_tp3_no_limit = std(data3(:,8)*8000/M);
error_tp4_no_limit = std(data4(:,8)*8000/M);

q1_no_limit = mean(data1(:,7)/K);
q2_no_limit = mean(data2(:,7)/K);
q3_no_limit = mean(data3(:,7)/K);
q4_no_limit = mean(data4(:,7)/K);

error_q1_no_limit = std(data1(:,7)/K);
error_q2_no_limit = std(data2(:,7)/K);
error_q3_no_limit = std(data3(:,7)/K);
error_q4_no_limit = std(data4(:,7)/K);

%limit bw
data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\mpip.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\mptcp.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\together.csv');

mpip_limit = mean(data1(:,1)/M);
mptcp_limit = mean(data2(:,1)/M);
together_limit = mean(data3(:,1)/M);

error_mpip_limit = std(data1(:,1)/M);
error_mptcp_limit = std(data2(:,1)/M);
error_together_limit = std(data3(:,1)/M);

data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\1.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\2.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\3.csv');
data4 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\5\4.csv');


tp1_limit = mean(data1(:,8)*8000/M);
tp2_limit = mean(data2(:,8)*8000/M);
tp3_limit = mean(data3(:,8)*8000/M);
tp4_limit = mean(data4(:,8)*8000/M);

error_tp1_limit = std(data1(:,8)*8000/M);
error_tp2_limit = std(data2(:,8)*8000/M);
error_tp3_limit = std(data3(:,8)*8000/M);
error_tp4_limit = std(data4(:,8)*8000/M);


q1_limit = mean(data1(:,7)/K);
q2_limit = mean(data2(:,7)/K);
q3_limit = mean(data3(:,7)/K);
q4_limit = mean(data4(:,7)/K);

error_q1_limit = std(data1(:,7)/K);
error_q2_limit = std(data2(:,7)/K);
error_q3_limit = std(data3(:,7)/K);
error_q4_limit = std(data4(:,7)/K);


%delay
data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\mpip.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\mptcp.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\together.csv');

mpip_delay = mean(data1(:,1)/M);
mptcp_delay = mean(data2(:,1)/M);
together_delay = mean(data3(:,1)/M);

error_mpip_delay = std(data1(:,1)/M);
error_mptcp_delay = std(data2(:,1)/M);
error_together_delay = std(data3(:,1)/M);

data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\1.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\2.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\3.csv');
data4 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\6\4.csv');

tp1_delay = mean(data1(:,8)*8000/M);
tp2_delay = mean(data2(:,8)*8000/M);
tp3_delay = mean(data3(:,8)*8000/M);
tp4_delay = mean(data4(:,8)*8000/M);

error_tp1_delay = std(data1(:,8)*8000/M);
error_tp2_delay = std(data2(:,8)*8000/M);
error_tp3_delay = std(data3(:,8)*8000/M);
error_tp4_delay = std(data4(:,8)*8000/M);

q1_delay = mean(data1(:,7)/K);
q2_delay = mean(data2(:,7)/K);
q3_delay = mean(data3(:,7)/K);
q4_delay = mean(data4(:,7)/K);

error_q1_delay = std(data1(:,7)/K);
error_q2_delay = std(data2(:,7)/K);
error_q3_delay = std(data3(:,7)/K);
error_q4_delay = std(data4(:,7)/K);

%wireless
data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\mpip.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\mptcp.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\together.csv');

mpip_wireless = mean(data1(:,1)/M);
mptcp_wireless = mean(data2(:,1)/M);
together_wireless = mean(data3(:,1)/M);

error_mpip_wireless = std(data1(:,1)/M);
error_mptcp_wireless = std(data2(:,1)/M);
error_together_wireless = std(data3(:,1)/M);


data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\1.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\2.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\3.csv');
data4 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\7\4.csv');

tp1_wireless = mean(data1(:,8)*8000/M);
tp2_wireless = mean(data2(:,8)*8000/M);
tp3_wireless = mean(data3(:,8)*8000/M);
tp4_wireless = mean(data4(:,8)*8000/M);

error_tp1_wireless = std(data1(:,8)*8000/M);
error_tp2_wireless = std(data2(:,8)*8000/M);
error_tp3_wireless = std(data3(:,8)*8000/M);
error_tp4_wireless = std(data4(:,8)*8000/M);


q1_wireless = mean(data1(:,7)/K);
q2_wireless = mean(data2(:,7)/K);
q3_wireless = mean(data3(:,7)/K);
q4_wireless = mean(data4(:,7)/K);

error_q1_wireless = std(data1(:,7)/K);
error_q2_wireless = std(data2(:,7)/K);
error_q3_wireless = std(data3(:,7)/K);
error_q4_wireless = std(data4(:,7)/K);

%pair limit
data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\mpip.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\mptcp.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\together.csv');

mpip_pair = mean(data1(:,1)/M);
mptcp_pair = mean(data2(:,1)/M);
together_pair = mean(data3(:,1)/M);

error_mpip_pair = std(data1(:,1)/M);
error_mptcp_pair = std(data2(:,1)/M);
error_together_pair = std(data3(:,1)/M);

data1 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\1.csv');
data2 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\2.csv');
data3 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\3.csv');
data4 = csvread('Z:\home\bill\gbtian\research\kernel\mptcp\conext14\experiment\data\11\4.csv');

tp1_pair = mean(data1(:,8)*8000/M);
tp2_pair = mean(data2(:,8)*8000/M);
tp3_pair = mean(data3(:,8)*8000/M);
tp4_pair = mean(data4(:,8)*8000/M);

error_tp1_pair = std(data1(:,8)*8000/M);
error_tp2_pair = std(data2(:,8)*8000/M);
error_tp3_pair = std(data3(:,8)*8000/M);
error_tp4_pair = std(data4(:,8)*8000/M);

q1_pair = mean(data1(:,7)/K);
q2_pair = mean(data2(:,7)/K);
q3_pair = mean(data3(:,7)/K);
q4_pair = mean(data4(:,7)/K);


error_q1_pair = std(data1(:,7)/K);
error_q2_pair = std(data2(:,7)/K);
error_q3_pair = std(data3(:,7)/K);
error_q4_pair = std(data4(:,7)/K);

tp = [mpip_no_limit mptcp_no_limit together_no_limit; 
%         mpip_limit mptcp_limit together_limit;
        mpip_pair mptcp_pair together_pair; 
        mpip_delay mptcp_delay together_delay; 
        mpip_wireless mptcp_wireless together_wireless];

error_tp = [error_mpip_no_limit error_mptcp_no_limit error_together_no_limit; 
        error_mpip_pair error_mptcp_pair error_together_pair; 
        error_mpip_delay error_mptcp_delay error_together_delay; 
        error_mpip_wireless error_mptcp_wireless error_together_wireless];
    
figure;
set(gcf,'outerposition',get(0,'screensize'));
hold on;
grid on;
h=bar(tp);
% 
% for i=1:length(h)    
%     XDATA=get(get(h(i),'Children'),'XData');
%     YDATA=get(get(h(i),'Children'),'YData');
% 
%     for j=1:size(XDATA,2)
%             x=XDATA(1,j)+(XDATA(3,j)-XDATA(1,j))/2-0.07;
%             y=YDATA(2,j)+5;
%             t=[num2str(YDATA(2,j),3) ];
%             text(x,y,t,'Color','k','fontsize',10)
%     end
% end

set(gca,'XTickLabel',{'', 'No Limit', '', 'Bandwidth Limit', '', 'Added Delay', '', 'Wireless'},'fontsize',15)
legend('MPIP', 'MPTCP', 'Together');

numgroups = size(tp, 1); 
numbars = size(tp, 2); 
groupwidth = min(0.8, numbars/(numbars+1.5));
for i = 1:numbars
      % Based on barweb.m by Bolu Ajiboye from MATLAB File Exchange
      x = (1:numgroups) - groupwidth/2 + (2*i-1) * groupwidth / (2*numbars);  % Aligning error bar with individual bar
      h = errorbar(x, tp(:,i), error_tp(:,i), 'k', 'linestyle', 'none', );
      set(h(2),'Linewidth',30)
end

% xlabel('','fontsize',15);
ylabel('Mbps','fontsize',15);
ylim([0 200])
